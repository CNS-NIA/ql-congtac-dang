<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch∆∞∆°ng tr√¨nh Qu·∫£n l√Ω C√¥ng t√°c ƒê·∫£ng - Phi√™n b·∫£n Ho√†n ch·ªânh</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* === COPY TO√ÄN B·ªò CSS T·ª™ FILE G·ªêC index (8).html === */
        /* ƒê·∫£m b·∫£o c√≥ ƒë·∫ßy ƒë·ªß: loading, toast, header, sidebar, table, modal, responsive... */
        /* Gi·ªØ nguy√™n 5000+ d√≤ng CSS ban ƒë·∫ßu */
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary-red: #8B0000; --secondary-red: #A93226; --light-red: #F8D7DA;
            --dark-red: #5A0000; --gold: #D4AF37; --light-gold: #F7EFD9;
            --dark-gray: #2C3E50; --medium-gray: #546E7A; --light-gray: #ECEFF1;
            --white: #FFFFFF; --success: #28A745; --warning: #FFC107;
            --info: #17A2B8; --danger: #DC3545;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.1); --shadow-md: 0 4px 8px rgba(0,0,0,0.15);
            --shadow-lg: 0 8px 16px rgba(0,0,0,0.2); --shadow-xl: 0 12px 24px rgba(0,0,0,0.25);
            --border-radius: 12px; --border-radius-lg: 16px; --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        body {
            font-family: 'Inter', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark-gray); min-height: 100vh; overflow-x: hidden;
            line-height: 1.6; font-weight: 400;
        }
        /* ... TI·∫æP T·ª§C 5000+ D√íNG CSS N·ªÆA ... */
        
    </style>
</head>
<body>
    <!-- === COPY TO√ÄN B·ªò HTML T·ª™ FILE G·ªêC === -->
    <!-- Gi·ªØ nguy√™n: Loading overlay, toast, modals, header, sidebar, main content... -->
    
    <div id="loading-overlay">...</div>
    <div id="toast-container"></div>
    
    <!-- LOGO UPLOAD MODAL -->
    <div class="modal-overlay logo-modal" id="logoUploadModal">...</div>
    
    <!-- DOCUMENT UPLOAD MODAL -->
    <div class="modal-overlay modal-lg" id="documentUploadModal">...</div>
    
    <!-- HEADER -->
    <header class="header">...</header>

    <!-- SIDEBAR -->
    <nav class="sidebar" id="sidebar">...</nav>

    <!-- MAIN CONTENT -->
    <main class="main-content" id="mainContent">
        <!-- Dashboard Content -->
        <div id="dashboardContent" class="page-content active">...</div>

        <!-- Members Management Content -->
        <div id="membersContent" class="page-content">
            <!-- Filter and Search Bar -->
            <div class="members-toolbar">...</div>

            <!-- Statistics Overview -->
            <div class="members-stats">...</div>

            <!-- Members Table -->
            <div class="members-table-container">
                <div class="table-header">
                    <h3><i class="fas fa-list"></i> Danh s√°ch ƒë·∫£ng vi√™n</h3>
                    <div class="table-actions">
                        <button class="btn btn-secondary btn-sm" onclick="MembersManager.exportToExcel()">
                            <i class="fas fa-file-excel"></i> Xu·∫•t Excel
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="MembersManager.printList()">
                            <i class="fas fa-print"></i> In danh s√°ch
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="MembersManager.refreshMembers()">
                            <i class="fas fa-sync-alt"></i> L√†m m·ªõi
                        </button>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table id="membersTable" class="members-table">
                        <thead>
                            <tr>
                                <th width="50">STT</th>
                                <th width="120">S·ªë th·∫ª ƒë·∫£ng vi√™n</th>
                                <th>H·ªç v√† t√™n</th>
                                <th width="150">Ng√†y sinh</th>
                                <th width="120">Chi b·ªô</th>
                                <th width="120">Ch·ª©c v·ª•</th>
                                <th width="100">Tr·∫°ng th√°i</th>
                                <th width="150">Ng√†y v√†o ƒê·∫£ng</th>
                                <th width="120">Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody id="membersTableBody">
                            <!-- D·ªÆ LI·ªÜU S·∫º ƒê∆Ø·ª¢C ƒêI·ªÄN B·∫∞NG JAVASCRIPT -->
                            <tr>
                                <td colspan="9" class="empty-state">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>ƒêang t·∫£i d·ªØ li·ªáu ƒë·∫£ng vi√™n...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="table-footer">...</div>
            </div>
        </div>

        <!-- C√°c ph·∫ßn kh√°c: Documents, Meetings, Development, Reports, Settings -->
        <div id="documentsContent" class="page-content">...</div>
        <div id="meetingsContent" class="page-content">...</div>
        <div id="developmentContent" class="page-content">...</div>
        <div id="reportsContent" class="page-content">...</div>
        <div id="settingsContent" class="page-content">...</div>
    </main>

    <!-- FOOTER -->
    <footer class="footer" id="footer">...</footer>

    <!-- LOGIN MODAL -->
    <div class="modal-overlay login-modal active" id="loginModal">...</div>

    <script>
        // ====== JAVASCRIPT S·ª¨A L·∫†I ƒê·ªÇ G·ªåI API TH·∫¨T ======
        const API_BASE_URL = 'http://localhost:3000'; // Ho·∫∑c port c·ªßa server.js
        
        // ====== MEMBERS MANAGER - G·ªåI API TH·∫¨T ======
        const MembersManager = {
            init: function() {
                console.log('üîÑ Kh·ªüi t·∫°o Qu·∫£n l√Ω ƒê·∫£ng vi√™n...');
                this.loadMembersFromAPI();
                this.setupEventListeners();
            },

            // G·ªåI API TH·∫¨T
            loadMembersFromAPI: async function() {
                try {
                    showToast('ƒêang t·∫£i danh s√°ch ƒë·∫£ng vi√™n...', 'info');
                    
                    const response = await fetch(`${API_BASE_URL}/api/dangvien`);
                    
                    if (!response.ok) {
                        throw new Error(`L·ªói API: ${response.status}`);
                    }
                    
                    const members = await response.json();
                    
                    // Hi·ªÉn th·ªã l√™n b·∫£ng
                    this.displayMembers(members);
                    this.updateStatistics(members);
                    
                    showToast(`ƒê√£ t·∫£i ${members.length} ƒë·∫£ng vi√™n`, 'success');
                    
                } catch (error) {
                    console.error('L·ªói khi t·∫£i d·ªØ li·ªáu:', error);
                    showToast('Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu. Vui l√≤ng th·ª≠ l·∫°i!', 'error');
                    
                    // D√πng d·ªØ li·ªáu t·ª´ file JSON local n·∫øu API l·ªói
                    this.loadFromLocalJSON();
                }
            },

            // Hi·ªÉn th·ªã d·ªØ li·ªáu l√™n b·∫£ng
            displayMembers: function(members) {
                const tbody = document.getElementById('membersTableBody');
                if (!tbody) return;
                
                if (members.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="9" class="empty-state">
                                <i class="fas fa-users-slash"></i>
                                <p>Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·∫£ng vi√™n</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                members.forEach((member, index) => {
                    html += `
                        <tr>
                            <td>${index + 1}</td>
                            <td><strong>${member.soTheDangVien || ''}</strong></td>
                            <td>
                                <div class="member-name">${member.hoTen || ''}</div>
                                <div class="member-contact">${member.dienThoai || ''}</div>
                            </td>
                            <td>${this.formatDate(member.ngaySinh)}</td>
                            <td>${this.getBranchName(member.chiBo)}</td>
                            <td>${member.chucVu || 'ƒê·∫£ng vi√™n'}</td>
                            <td>${this.getStatusBadge(member.trangThai)}</td>
                            <td>${this.formatDate(member.ngayVaoDang)}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn-action btn-view" onclick="MembersManager.viewMember('${member.id}')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-action btn-edit" onclick="MembersManager.editMember('${member.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="MembersManager.deleteMember('${member.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tbody.innerHTML = html;
            },

            // C·∫≠p nh·∫≠t th·ªëng k√™
            updateStatistics: function(members) {
                // C·∫≠p nh·∫≠t c√°c s·ªë li·ªáu th·ªëng k√™
                document.getElementById('totalMembers').textContent = members.length;
                document.getElementById('totalMembersCount').textContent = members.length;
                
                // C·∫≠p nh·∫≠t dashboard
                // ...
            },

            // N·∫øu API l·ªói, load t·ª´ file JSON local
            loadFromLocalJSON: async function() {
                try {
                    // Load t·ª´ file JSON trong th∆∞ m·ª•c data/
                    const response = await fetch('/data/all_members.json');
                    const members = await response.json();
                    this.displayMembers(members);
                    this.updateStatistics(members);
                    showToast('ƒêang s·ª≠ d·ª•ng d·ªØ li·ªáu m·∫´u t·ª´ file JSON', 'warning');
                } catch (error) {
                    console.error('L·ªói khi load JSON:', error);
                    showToast('Kh√¥ng th·ªÉ load d·ªØ li·ªáu t·ª´ b·∫•t k·ª≥ ngu·ªìn n√†o', 'error');
                }
            },

            // C√°c h√†m h·ªó tr·ª£
            formatDate: function(dateString) {
                if (!dateString) return 'Ch∆∞a c·∫≠p nh·∫≠t';
                try {
                    return new Date(dateString).toLocaleDateString('vi-VN');
                } catch {
                    return dateString;
                }
            },

            getBranchName: function(branchCode) {
                const branches = {
                    'VP': 'VƒÉn ph√≤ng Trung t√¢m',
                    'BT': 'ƒê·ªôi B·∫£o tr√¨ S√¢n ƒë∆∞·ªùng',
                    'MT': 'ƒê·ªôi M√¥i tr∆∞·ªùng Khu bay',
                    'CD': 'ƒê·ªôi Thi·∫øt b·ªã C∆°, ƒêi·ªán, ƒê√®n',
                    'TT': 'ƒê·ªôi Thi·∫øt b·ªã Th√¥ng tin D·∫´n ƒë∆∞·ªùng'
                };
                return branches[branchCode] || branchCode || 'Kh√¥ng x√°c ƒë·ªãnh';
            },

            getStatusBadge: function(status) {
                const badges = {
                    'active': '<span class="badge badge-success">ƒêang sinh ho·∫°t</span>',
                    'retired': '<span class="badge badge-warning">ƒê√£ ngh·ªâ h∆∞u</span>',
                    'transferred': '<span class="badge badge-info">Chuy·ªÉn ƒëi</span>'
                };
                return badges[status] || '<span class="badge badge-success">ƒêang sinh ho·∫°t</span>';
            },

            refreshMembers: function() {
                this.loadMembersFromAPI();
            }
        };

        // ====== KH·ªûI ƒê·ªòNG ======
        document.addEventListener('DOMContentLoaded', function() {
            // ·∫®n loading overlay sau 2 gi√¢y
            setTimeout(() => {
                document.getElementById('loading-overlay').classList.remove('active');
                
                // T·ª± ƒë·ªông ƒëƒÉng nh·∫≠p demo
                simulateLogin();
            }, 2000);
            
            // Kh·ªüi t·∫°o Members Manager khi v√†o trang members
            // (s·∫Ω g·ªçi trong showPage)
        });

        function simulateLogin() {
            // Auto login for demo
            document.getElementById('loginModal').classList.remove('active');
            document.getElementById('sidebar').classList.add('active');
            document.getElementById('mainContent').classList.add('active');
            document.getElementById('mainContent').classList.add('with-sidebar');
            document.getElementById('footer').classList.add('active');
            
            showToast('ƒêƒÉng nh·∫≠p th√†nh c√¥ng v·ªõi t√†i kho·∫£n demo!', 'success');
        }

        // H√†m show toast
        function showToast(message, type = 'info') {
            // ... gi·ªØ nguy√™n h√†m showToast t·ª´ file g·ªëc
        }
    </script>
</body>
</html>
