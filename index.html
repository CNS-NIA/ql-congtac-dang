<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hồ sơ Đảng viên - Quản lý thông tin</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary-red: #8B0000;
            --secondary-red: #A93226;
            --gold: #D4AF37;
            --light-gray: #f5f5f5;
            --dark-gray: #333;
        }
        
        body {
            background: var(--light-gray);
            color: var(--dark-gray);
            line-height: 1.6;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--secondary-red) 100%);
            color: white;
            padding: 20px 40px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 4px solid var(--gold);
        }
        
        .header h1 {
            font-size: 28px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .back-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 8px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .container {
            max-width: 1400px;
            margin: 40px auto;
            padding: 0 20px;
        }
        
        .page-title {
            color: var(--primary-red);
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--gold);
            font-size: 32px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .content-box {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            border: 1px solid rgba(139, 0, 0, 0.1);
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        
        .tab-btn {
            padding: 12px 25px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-weight: 600;
            color: #495057;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tab-btn:hover {
            background: #e9ecef;
        }
        
        .tab-btn.active {
            background: var(--primary-red);
            color: white;
            border-color: var(--primary-red);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .stats-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 25px;
            border-radius: 12px;
            border-left: 5px solid var(--primary-red);
            transition: transform 0.3s;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
        }
        
        .stats-card h3 {
            color: var(--primary-red);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stat-item {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px dashed #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .stat-label {
            font-weight: 600;
            color: #555;
        }
        
        .stat-value {
            color: #222;
            font-size: 16px;
            font-weight: 600;
        }
        
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 10px;
            border: 1px solid #dee2e6;
        }
        
        .member-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            min-width: 1000px;
        }
        
        .member-table th {
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--secondary-red) 100%);
            color: white;
            padding: 18px 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        .member-table td {
            padding: 16px 15px;
            border-bottom: 1px solid #eee;
        }
        
        .member-table tr:hover {
            background: #f8f9fa;
        }
        
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-chinh-thuc {
            background: #d4edda;
            color: #155724;
        }
        
        .status-du-bi {
            background: #fff3cd;
            color: #856404;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 14px 28px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            font-size: 15px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--secondary-red) 100%);
            color: white;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
            font-size: 18px;
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-red);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-message {
            text-align: center;
            padding: 50px;
            color: #dc3545;
        }
        
        .info-message {
            background: #e7f3ff;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            color: #0c5460;
        }
        
        .success-message {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            color: #155724;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        
        .modal-title {
            color: var(--primary-red);
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 5px;
        }
        
        .close-btn:hover {
            color: var(--primary-red);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 15px;
            transition: border 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-red);
            box-shadow: 0 0 0 3px rgba(139, 0, 0, 0.1);
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 768px) {
            .header {
                padding: 15px 20px;
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .header h1 {
                font-size: 22px;
            }
            
            .container {
                margin: 20px auto;
                padding: 0 15px;
            }
            
            .content-box {
                padding: 25px;
            }
            
            .page-title {
                font-size: 26px;
            }
            
            .tabs {
                justify-content: center;
            }
            
            .tab-btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                justify-content: center;
            }
            
            .form-row {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="header">
        <h1>
            <i class="fas fa-users"></i>
            HỒ SƠ ĐẢNG VIÊN - TRUNG TÂM QLBVSB NỘI BÀI
        </h1>
        <a href="../index.html" class="back-btn">
            <i class="fas fa-arrow-left"></i>
            Quay lại trang chủ
        </a>
    </div>

    <div class="container">
        <h2 class="page-title">
            <i class="fas fa-id-card"></i>
            Quản lý thông tin đảng viên
        </h2>
        
        <div class="content-box">
            <div id="infoMessage" class="success-message">
                <i class="fas fa-check-circle"></i> 
                <span id="infoText">Đã tải thành công dữ liệu từ 5 chi bộ. Tổng cộng 101 đảng viên.</span>
            </div>
            
            <div class="stats-grid">
                <div class="stats-card">
                    <h3><i class="fas fa-chart-pie"></i> Thống kê tổng quan</h3>
                    <div class="stat-item">
                        <span class="stat-label">Tổng số đảng viên:</span>
                        <span class="stat-value" id="totalMembers">101</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Đảng viên chính thức:</span>
                        <span class="stat-value" id="totalChinhThuc">96</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Đảng viên dự bị:</span>
                        <span class="stat-value" id="totalDuBi">5</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Số chi bộ có dữ liệu:</span>
                        <span class="stat-value" id="activeChiBo">5/5</span>
                    </div>
                </div>
                
                <div class="stats-card">
                    <h3><i class="fas fa-user-plus"></i> Phát triển đảng</h3>
                    <div class="stat-item">
                        <span class="stat-label">Đảng viên mới 2024:</span>
                        <span class="stat-value" id="newMembers2025">4</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Đang xét kết nạp:</span>
                        <span class="stat-value" id="pendingMembers">5</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Quần chúng ưu tú:</span>
                        <span class="stat-value" id="uuTuMembers">21</span>
                    </div>
                </div>
                
                <div class="stats-card">
                    <h3><i class="fas fa-calendar-alt"></i> Sinh hoạt đảng</h3>
                    <div class="stat-item">
                        <span class="stat-label">Tham gia tháng này:</span>
                        <span class="stat-value" id="attendanceRate">96%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Đảng viên chuyển đi:</span>
                        <span class="stat-value" id="transferredOut">3</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Đảng viên chuyển đến:</span>
                        <span class="stat-value" id="transferredIn">2</span>
                    </div>
                </div>
            </div>
            
            <div class="tabs" id="chiBoTabs">
                <button class="tab-btn active" data-chibo="doi-thiet-bi-thong-tin-dan-duong" onclick="switchTab('doi-thiet-bi-thong-tin-dan-duong')">
                    <i class="fas fa-microchip"></i> Đội TTDD
                </button>
                <button class="tab-btn" data-chibo="van-phong-trung-tam" onclick="switchTab('van-phong-trung-tam')">
                    <i class="fas fa-building"></i> Văn phòng
                </button>
                <button class="tab-btn" data-chibo="doi-thiet-bi-co-dien-den-sb" onclick="switchTab('doi-thiet-bi-co-dien-den-sb')">
                    <i class="fas fa-bolt"></i> Cơ điện
                </button>
                <button class="tab-btn" data-chibo="doi-moi-truong-khu-bay" onclick="switchTab('doi-moi-truong-khu-bay')">
                    <i class="fas fa-leaf"></i> Môi trường
                </button>
                <button class="tab-btn" data-chibo="doi-bao-tri-san-duong" onclick="switchTab('doi-bao-tri-san-duong')">
                    <i class="fas fa-road"></i> Sân đường
                </button>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="showAddMemberModal()">
                    <i class="fas fa-plus-circle"></i>
                    Thêm đảng viên
                </button>
                <button class="btn btn-success" onclick="exportToExcel()">
                    <i class="fas fa-file-excel"></i>
                    Xuất Excel
                </button>
                <button class="btn btn-secondary" onclick="showSearchModal()">
                    <i class="fas fa-search"></i>
                    Tìm kiếm
                </button>
                <button class="btn btn-warning" onclick="showAdvancedSearch()">
                    <i class="fas fa-filter"></i>
                    Lọc nâng cao
                </button>
                <button class="btn btn-secondary" onclick="refreshData()">
                    <i class="fas fa-sync-alt"></i>
                    Làm mới
                </button>
            </div>
            
            <div id="tabContent">
                <!-- Dữ liệu sẽ được tải ở đây -->
            </div>
        </div>
    </div>

    <!-- Modal Thêm đảng viên -->
    <div id="addMemberModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-user-plus"></i> Thêm đảng viên mới
                </h3>
                <button class="close-btn" onclick="closeAddMemberModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addMemberForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="newHoVaTen"><i class="fas fa-user"></i> Họ và tên *</label>
                        <input type="text" id="newHoVaTen" class="form-control" placeholder="Nhập họ và tên" required>
                    </div>
                    <div class="form-group">
                        <label for="newNgaySinh"><i class="fas fa-birthday-cake"></i> Ngày sinh</label>
                        <input type="text" id="newNgaySinh" class="form-control" placeholder="dd.mm.yyyy">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="newNgayVaoDang"><i class="fas fa-calendar-day"></i> Ngày vào Đảng</label>
                        <input type="text" id="newNgayVaoDang" class="form-control" placeholder="dd.mm.yyyy">
                    </div>
                    <div class="form-group">
                        <label for="newSoTheDang"><i class="fas fa-id-card"></i> Số thẻ Đảng</label>
                        <input type="text" id="newSoTheDang" class="form-control" placeholder="Nhập số thẻ">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="newChucVu"><i class="fas fa-briefcase"></i> Chức vụ</label>
                        <input type="text" id="newChucVu" class="form-control" placeholder="Nhập chức vụ">
                    </div>
                    <div class="form-group">
                        <label for="newChucVuDang"><i class="fas fa-star"></i> Chức vụ Đảng</label>
                        <select id="newChucVuDang" class="form-control">
                            <option value="">-- Chọn --</option>
                            <option value="BTCB">Bí thư Chi bộ</option>
                            <option value="Phó BTCB">Phó Bí thư</option>
                            <option value="CUV">Chi ủy viên</option>
                            <option value="ĐVDB">Đảng viên dự bị</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="newTrinhDo"><i class="fas fa-graduation-cap"></i> Trình độ</label>
                    <input type="text" id="newTrinhDo" class="form-control" placeholder="Ví dụ: 12/12 - KS Điện tử">
                </div>
                
                <div class="form-group">
                    <label for="newQueQuan"><i class="fas fa-map-marker-alt"></i> Quê quán</label>
                    <input type="text" id="newQueQuan" class="form-control" placeholder="Nhập quê quán">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="newChiBo"><i class="fas fa-sitemap"></i> Chi bộ *</label>
                        <select id="newChiBo" class="form-control" required>
                            <option value="">-- Chọn chi bộ --</option>
                            <option value="doi-thiet-bi-thong-tin-dan-duong">Đội Thiết bị TTDD</option>
                            <option value="van-phong-trung-tam">Văn phòng Trung tâm</option>
                            <option value="doi-thiet-bi-co-dien-den-sb">Đội Thiết bị Cơ điện</option>
                            <option value="doi-moi-truong-khu-bay">Đội Môi trường Khu bay</option>
                            <option value="doi-bao-tri-san-duong">Đội Bảo trì Sân đường</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="newTrangThai"><i class="fas fa-flag"></i> Trạng thái</label>
                        <select id="newTrangThai" class="form-control">
                            <option value="Chính thức">Chính thức</option>
                            <option value="Dự bị">Dự bị</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeAddMemberModal()">
                        <i class="fas fa-times"></i> Hủy
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Lưu đảng viên
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Tìm kiếm -->
    <div id="searchModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-search"></i> Tìm kiếm đảng viên
                </h3>
                <button class="close-btn" onclick="closeSearchModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="form-group">
                <label for="searchKeyword"><i class="fas fa-key"></i> Từ khóa tìm kiếm</label>
                <input type="text" id="searchKeyword" class="form-control" placeholder="Nhập tên, chức vụ, quê quán...">
            </div>
            <div class="form-group">
                <label for="searchChiBo"><i class="fas fa-sitemap"></i> Lọc theo chi bộ</label>
                <select id="searchChiBo" class="form-control">
                    <option value="">Tất cả chi bộ</option>
                    <option value="doi-thiet-bi-thong-tin-dan-duong">Đội Thiết bị TTDD</option>
                    <option value="van-phong-trung-tam">Văn phòng Trung tâm</option>
                    <option value="doi-thiet-bi-co-dien-den-sb">Đội Thiết bị Cơ điện</option>
                    <option value="doi-moi-truong-khu-bay">Đội Môi trường Khu bay</option>
                    <option value="doi-bao-tri-san-duong">Đội Bảo trì Sân đường</option>
                </select>
            </div>
            <div class="form-group">
                <label for="searchTrangThai"><i class="fas fa-flag"></i> Lọc theo trạng thái</label>
                <select id="searchTrangThai" class="form-control">
                    <option value="">Tất cả trạng thái</option>
                    <option value="Chính thức">Chính thức</option>
                    <option value="Dự bị">Dự bị</option>
                </select>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeSearchModal()">
                    <i class="fas fa-times"></i> Đóng
                </button>
                <button type="button" class="btn btn-primary" onclick="performSearch()">
                    <i class="fas fa-search"></i> Tìm kiếm
                </button>
            </div>
            <div id="searchResults" style="margin-top: 20px; max-height: 300px; overflow-y: auto; display: none;">
                <!-- Kết quả tìm kiếm sẽ hiển thị ở đây -->
            </div>
        </div>
    </div>

    <script>
        // ========== DỮ LIỆU NHÚNG HOÀN CHỈNH ==========
        const embeddedData = {
            'doi-thiet-bi-thong-tin-dan-duong': [
                {
                    "STT": 1,
                    "Anh": "",
                    "Ho_va_Ten": "Trần Đỗ Hải",
                    "Ngay_sinh": "27.12.1971",
                    "Ngay_vao_Dang": "27.10.2005",
                    "So_the_Dang": "92031354 043192",
                    "Chuc_vu": "Đội trưởng",
                    "Trinh_do": "12/12 - KS vô tuyến điện",
                    "Que_quan": "Xã Bát Tràng, TP. Hà Nội",
                    "Chuc_vu_Dang": "BTCB"
                },
                {
                    "STT": 2,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Tuấn Anh",
                    "Ngay_sinh": "23.09.72",
                    "Ngay_vao_Dang": "03.02.2005",
                    "So_the_Dang": "92029785 044158",
                    "Chuc_vu": "Phó đội trưởng",
                    "Trinh_do": "12/12 - KS Điện tử",
                    "Que_quan": "Phường Vĩnh Phú, Tỉnh Nghệ An",
                    "Chuc_vu_Dang": "Phó BTCB"
                },
                {
                    "STT": 3,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Thượng Hiền",
                    "Ngay_sinh": "01.11.82",
                    "Ngay_vao_Dang": "06.08.2010",
                    "So_the_Dang": "83.015114 044836",
                    "Chuc_vu": "Phó đội trưởng",
                    "Trinh_do": "12/12 - KS kỹ thuật điện tử- Viễn thông",
                    "Que_quan": "Xã Đông Anh, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 4,
                    "Anh": "",
                    "Ho_va_Ten": "Phạm Minh Quang",
                    "Ngay_sinh": "05.04.75",
                    "Ngay_vao_Dang": "31.12.2010",
                    "So_the_Dang": "83013521 044842",
                    "Chuc_vu": "Phó đội trưởng",
                    "Trinh_do": "12/12 - KS Điện tử VT",
                    "Que_quan": "Xã Trung Giã, thành phố Hà Nội",
                    "Chuc_vu_Dang": "CUV"
                },
                {
                    "STT": 5,
                    "Anh": "",
                    "Ho_va_Ten": "Bùi Hồng Kỳ",
                    "Ngay_sinh": "07.03.71",
                    "Ngay_vao_Dang": "27.10.2005",
                    "So_the_Dang": "92031353 043195",
                    "Chuc_vu": "Tổ phó",
                    "Trinh_do": "12/12 - KS điện tử viễn thông",
                    "Que_quan": "Xã Nam Tiên Hưng, Tỉnh Hưng yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 6,
                    "Anh": "",
                    "Ho_va_Ten": "Trần Quốc Hoàn",
                    "Ngay_sinh": "08.12.1991",
                    "Ngay_vao_Dang": "28.05.2015",
                    "So_the_Dang": "14113917 790305",
                    "Chuc_vu": "Kỹ sư, Tổ phó",
                    "Trinh_do": "12/12 - KS Điện, điện tử",
                    "Que_quan": "Xã Nghĩa Hưng, Tỉnh Ninh Bình",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 7,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Quốc Chung",
                    "Ngay_sinh": "28.05.1972",
                    "Ngay_vao_Dang": "10.08.2012",
                    "So_the_Dang": "83022757 045461",
                    "Chuc_vu": "Kỹ thuật viên",
                    "Trinh_do": "12/12 - KS điện tử- VT",
                    "Que_quan": "Phường Cửa Lò, Tỉnh Nghệ An",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 8,
                    "Anh": "",
                    "Ho_va_Ten": "Bùi Liên Hương",
                    "Ngay_sinh": "18.4.1975",
                    "Ngay_vao_Dang": "28.12.1999",
                    "So_the_Dang": "15029404",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - CĐ Tiếng Anh sư phạm",
                    "Que_quan": "Xã Nam Hoa Lư, Tỉnh Ninh Bình",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 9,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Ngọc Linh",
                    "Ngay_sinh": "01.9.1992",
                    "Ngay_vao_Dang": "19.7.2019",
                    "So_the_Dang": "83047819",
                    "Chuc_vu": "Kỹ sư kỹ thuật",
                    "Trinh_do": "12/12 - KS điện tử viễn thông",
                    "Que_quan": "Xã Cát Ngạn, Tỉnh Nghệ An",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 10,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Văn Long",
                    "Ngay_sinh": "28.8.1988",
                    "Ngay_vao_Dang": "04.12.2019",
                    "So_the_Dang": "83050419",
                    "Chuc_vu": "Kỹ sư, Tổ phó",
                    "Trinh_do": "12/12 - KS kỹ thuật điều khiển và tự động hóa",
                    "Que_quan": "Xã Nội Bài, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 11,
                    "Anh": "",
                    "Ho_va_Ten": "Lê Tuấn Anh",
                    "Ngay_sinh": "21.10.1992",
                    "Ngay_vao_Dang": "04.12.2019",
                    "So_the_Dang": "83050422",
                    "Chuc_vu": "Nhân viên, Tổ phó K1",
                    "Trinh_do": "12/12 - CN công nghệ thông tin",
                    "Que_quan": "Xã Nội Bài, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 12,
                    "Anh": "",
                    "Ho_va_Ten": "Lê Văn Quang",
                    "Ngay_sinh": "26.7.1979",
                    "Ngay_vao_Dang": "01.11.2011",
                    "So_the_Dang": "83019941 045642",
                    "Chuc_vu": "Kỹ sư khai thác, bảo trì TTB KB",
                    "Trinh_do": "12/12 - ThS kỹ thuật, KS điện",
                    "Que_quan": "Xã Vạn Lộc, Tỉnh Thanh Hóa",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 13,
                    "Anh": "",
                    "Ho_va_Ten": "Hoàng Gia Phong",
                    "Ngay_sinh": "22.01.1990",
                    "Ngay_vao_Dang": "01.09.2021",
                    "So_the_Dang": "92101501",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - KS công nghệ kỹ thuật điện - điện tử",
                    "Que_quan": "Xã Hương Sơn, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 14,
                    "Anh": "",
                    "Ho_va_Ten": "Đỗ Trung Kiên",
                    "Ngay_sinh": "10.11.1988",
                    "Ngay_vao_Dang": "25.12.2021",
                    "So_the_Dang": "92101513",
                    "Chuc_vu": "Kỹ sư, Tổ phó",
                    "Trinh_do": "12/12 - KS Khoa học máy tính",
                    "Que_quan": "Xã Quang Minh, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 15,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Trọng Hiếu",
                    "Ngay_sinh": "23.12.70",
                    "Ngay_vao_Dang": "25.10.2005",
                    "So_the_Dang": "92031355 043190",
                    "Chuc_vu": "Phó GĐTT",
                    "Trinh_do": "12/12 - CN Tin học",
                    "Que_quan": "Phường Kinh Bắc, Tỉnh Bắc Ninh",
                    "Chuc_vu_Dang": "ĐUV ĐUBP"
                },
                {
                    "STT": 16,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Mạnh Cường",
                    "Ngay_sinh": "03/12/1993",
                    "Ngay_vao_Dang": "16/02/2023",
                    "So_the_Dang": "92105582",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - KS Kỹ thuật điện tử, truyền thông; Ths Hội tụ công nghệ",
                    "Que_quan": "Xã Sóc Sơn, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 17,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Minh Tuấn",
                    "Ngay_sinh": "14/7/1991",
                    "Ngay_vao_Dang": "16/02/2023",
                    "So_the_Dang": "92105581",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - KS Kỹ thuật điện tử, truyền thông; Ths Kỹ thuật viễn thông",
                    "Que_quan": "Xã Nam Xang, Tỉnh Ninh Bình",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 18,
                    "Anh": "",
                    "Ho_va_Ten": "Khúc Trường Sơn",
                    "Ngay_sinh": "17/11/1989",
                    "Ngay_vao_Dang": "19/7/2023",
                    "So_the_Dang": "92111721",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - KS công nghệ thông tin",
                    "Que_quan": "Xã Chương Dương, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 19,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Minh Đức",
                    "Ngay_sinh": "25/10/1992",
                    "Ngay_vao_Dang": "01/11/2023",
                    "So_the_Dang": "92108377",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - KS kỹ thuật điện tử truyền thông",
                    "Que_quan": "Xã Hợp Thịnh, Tỉnh Bắc Ninh",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 20,
                    "Anh": "",
                    "Ho_va_Ten": "Lê Hồng Thái",
                    "Ngay_sinh": "23/12/1995",
                    "Ngay_vao_Dang": "03/06/2022",
                    "So_the_Dang": "05372294",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - KS kỹ thuật điện tử, truyền thông",
                    "Que_quan": "Xã Sóc Sơn, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                }
            ],
            'van-phong-trung-tam': [
                {
                    "STT": 1,
                    "Anh": "",
                    "Ho_va_Ten": "Vũ Nam Thắng",
                    "Ngay_sinh": "31.08.73",
                    "Ngay_vao_Dang": "13.07.2005",
                    "So_the_Dang": "92030594",
                    "Chuc_vu": "Trưởng VP",
                    "Trinh_do": "12/12 - Ths Kỹ thuật, KS Kinh tế XD, KS Xây dựng",
                    "Que_quan": "Phường Trường Vinh, Tỉnh Nghệ An",
                    "Chuc_vu_Dang": "ĐUV BTCB"
                },
                {
                    "STT": 2,
                    "Anh": "",
                    "Ho_va_Ten": "Hồ Xuân Hoà",
                    "Ngay_sinh": "29.05.67",
                    "Ngay_vao_Dang": "11.08.1998",
                    "So_the_Dang": "92023306 043007",
                    "Chuc_vu": "Phó trưởng VP",
                    "Trinh_do": "12/12 - CN Luật",
                    "Que_quan": "Xã Quỳnh Phú, Tỉnh Nghệ An",
                    "Chuc_vu_Dang": "Phó BTCB"
                },
                {
                    "STT": 3,
                    "Anh": "",
                    "Ho_va_Ten": "Vũ Kỳ Phượng",
                    "Ngay_sinh": "29.10.1971",
                    "Ngay_vao_Dang": "09.10.2003",
                    "So_the_Dang": "92023284",
                    "Chuc_vu": "Phó trưởng VP",
                    "Trinh_do": "12/12 - CN Kế toàn",
                    "Que_quan": "Phường Đường Hào, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": "CUV"
                },
                {
                    "STT": 4,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Hồng Phú",
                    "Ngay_sinh": "24.11.67",
                    "Ngay_vao_Dang": "03.02.2001",
                    "So_the_Dang": "92023277 042960",
                    "Chuc_vu": "Chuyên viên",
                    "Trinh_do": "10/10 - CN chính trị + CN Kinh tế",
                    "Que_quan": "Xã Phong Doanh, Tỉnh Ninh Bình",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 5,
                    "Anh": "",
                    "Ho_va_Ten": "Lê Ánh Hồng",
                    "Ngay_sinh": "28.04.73",
                    "Ngay_vao_Dang": "18.12.1999",
                    "So_the_Dang": "92023276 042959",
                    "Chuc_vu": "Chuyên viên",
                    "Trinh_do": "12/12 - CN KTQD",
                    "Que_quan": "Xã Nông Cống, Tỉnh Thanh Hoá",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 6,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Văn Hiệp",
                    "Ngay_sinh": "16.12.72",
                    "Ngay_vao_Dang": "03.02.2001",
                    "So_the_Dang": "92023279 042974",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - CĐ QTDN",
                    "Que_quan": "Xã Sóc Sơn, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 7,
                    "Anh": "",
                    "Ho_va_Ten": "Vũ Thị Nhung",
                    "Ngay_sinh": "19.05.72",
                    "Ngay_vao_Dang": "09.04.2000",
                    "So_the_Dang": "92023283 042958",
                    "Chuc_vu": "Chuyên viên",
                    "Trinh_do": "12/12 - Cử nhân kế toán",
                    "Que_quan": "Xã Trực Ninh, Tỉnh Ninh Bình",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 8,
                    "Anh": "",
                    "Ho_va_Ten": "Đỗ Thị Thanh Mai",
                    "Ngay_sinh": "18.05.75",
                    "Ngay_vao_Dang": "12.09.2006",
                    "So_the_Dang": "92033833 044163",
                    "Chuc_vu": "Chuyên viên",
                    "Trinh_do": "12/12 - ĐH Mỏ địa chất",
                    "Que_quan": "Phường Xuân Đỉnh, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 9,
                    "Anh": "",
                    "Ho_va_Ten": "Hoàng Hà",
                    "Ngay_sinh": "27.11.1990",
                    "Ngay_vao_Dang": "13.7.2018",
                    "So_the_Dang": "83044316",
                    "Chuc_vu": "Chuyên viên",
                    "Trinh_do": "12/12 - ĐH Tài chính ngân hàng",
                    "Que_quan": "Phường Đông Ngạc, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 10,
                    "Anh": "",
                    "Ho_va_Ten": "Trần Trung Nghĩa",
                    "Ngay_sinh": "19.10.1988",
                    "Ngay_vao_Dang": "26.12.2018",
                    "So_the_Dang": "83045663",
                    "Chuc_vu": "Chuyên viên",
                    "Trinh_do": "12/12 - ĐH QTKD",
                    "Que_quan": "Xã Giao Thủy, Tỉnh Ninh Bình",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 11,
                    "Anh": "",
                    "Ho_va_Ten": "Ngô Thị Nga",
                    "Ngay_sinh": "07.6.1980",
                    "Ngay_vao_Dang": "21.7.2017",
                    "So_the_Dang": "83040955",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - SP Ngoại nhữ",
                    "Que_quan": "Xã Sóc Sơn, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 12,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Thị Hải Yến",
                    "Ngay_sinh": "06.9.1971",
                    "Ngay_vao_Dang": "08.7.2005",
                    "So_the_Dang": "92030615",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Cử nhân Anh văn",
                    "Que_quan": "Xã Kim Thành, TP. Hải Phòng",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 13,
                    "Anh": "",
                    "Ho_va_Ten": "Nông Thúy Lan",
                    "Ngay_sinh": "08.7.1974",
                    "Ngay_vao_Dang": "08.11.2014",
                    "So_the_Dang": "83030207",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Cử nhân QTKD",
                    "Que_quan": "Xã Nguyên Bình, Tỉnh Cao Bằng",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 14,
                    "Anh": "",
                    "Ho_va_Ten": "Phạm Văn Thái",
                    "Ngay_sinh": "29/10/1978",
                    "Ngay_vao_Dang": "17/10/2017",
                    "So_the_Dang": "92085702 223798",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - CN Luật, CN QTKD",
                    "Que_quan": "Xã Vạn Xuân, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 15,
                    "Anh": "",
                    "Ho_va_Ten": "Đào Thanh Hải",
                    "Ngay_sinh": "12/7/1984",
                    "Ngay_vao_Dang": "06/9/2020",
                    "So_the_Dang": "83050722",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Thạc sỹ Quản lý XD, KS XD cầu đường",
                    "Que_quan": "Xã Ý Yên, Tỉnh Ninh Bình",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 16,
                    "Anh": "",
                    "Ho_va_Ten": "Phạm Đức Phú Quang",
                    "Ngay_sinh": "19/12/1993",
                    "Ngay_vao_Dang": "19/12/2020",
                    "So_the_Dang": "83051659",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - Thạc sỹ khoa học kỹ thuật; Kỹ sư kỹ thuật hàng không",
                    "Que_quan": "Xã Ngọc Lâm, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 17,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Anh Tú",
                    "Ngay_sinh": "28/5/1994",
                    "Ngay_vao_Dang": "24/12/2022",
                    "So_the_Dang": "92105566",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - CN Quản trị kinh doanh",
                    "Que_quan": "Xã Đức Tân, Tỉnh Quảng Ngãi",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 18,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Thu Giang",
                    "Ngay_sinh": "29.06.1970",
                    "Ngay_vao_Dang": "27/11/2012",
                    "So_the_Dang": "83029769",
                    "Chuc_vu": "Chuyên viên",
                    "Trinh_do": "12/12 - KS XS cầu đường bộ, CN Anh văn",
                    "Que_quan": "Xã Thường Tín, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 19,
                    "Anh": "",
                    "Ho_va_Ten": "Ngô Anh Thủy",
                    "Ngay_sinh": "04.5.1987",
                    "Ngay_vao_Dang": "02.10.2014",
                    "So_the_Dang": "83028860",
                    "Chuc_vu": "NV",
                    "Trinh_do": "12/12 - KS Xây dựng dân dụng và CN",
                    "Que_quan": "Xã Quang Minh, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 20,
                    "Anh": "",
                    "Ho_va_Ten": "Lương Quốc Trung",
                    "Ngay_sinh": "02.9.1982",
                    "Ngay_vao_Dang": "20.11.2024",
                    "So_the_Dang": "",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - TC Kỹ thuật xây dựng",
                    "Que_quan": "Xã Trung Lộc, Tỉnh Nghệ An",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 21,
                    "Anh": "",
                    "Ho_va_Ten": "Lê Thị Thủy",
                    "Ngay_sinh": "17.8.1993",
                    "Ngay_vao_Dang": "",
                    "So_the_Dang": "",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Cao đẳng Quản trị nhân lực",
                    "Que_quan": "Xã Sóc Sơn, TP. Hà Nội",
                    "Chuc_vu_Dang": "ĐVDB"
                }
            ],
            'doi-thiet-bi-co-dien-den-sb': [
                {
                    "STT": 1,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Trung Dũng",
                    "Ngay_sinh": "16.09.68",
                    "Ngay_vao_Dang": "15.05.1989",
                    "So_the_Dang": "92023280 042970",
                    "Chuc_vu": "Đội trưởng",
                    "Trinh_do": "10/10 - Kỹ sư Điện, điện tử",
                    "Que_quan": "Xã Tứ Mỹ, Tỉnh Hà Tĩnh",
                    "Chuc_vu_Dang": "BTCB"
                },
                {
                    "STT": 2,
                    "Anh": "",
                    "Ho_va_Ten": "Lê Trường Giang",
                    "Ngay_sinh": "14.04.76",
                    "Ngay_vao_Dang": "05.11.2008",
                    "So_the_Dang": "83.018884 044730",
                    "Chuc_vu": "Phó đội trưởng",
                    "Trinh_do": "12/12 - KS Điện tử",
                    "Que_quan": "Xã Như Quỳnh, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": "CUV"
                },
                {
                    "STT": 3,
                    "Anh": "",
                    "Ho_va_Ten": "Bùi Việt Dũng",
                    "Ngay_sinh": "01.08.67",
                    "Ngay_vao_Dang": "22.07.1989",
                    "So_the_Dang": "92023417 042930",
                    "Chuc_vu": "Phó đội trưởng",
                    "Trinh_do": "10/10 - Kỹ sư Kỹ thuật Điện tử Viễn thông",
                    "Que_quan": "Xã Đức Thịnh, Tỉnh Hà Tĩnh",
                    "Chuc_vu_Dang": "Phó BTCB"
                },
                {
                    "STT": 4,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Văn Thuận",
                    "Ngay_sinh": "23.05.71",
                    "Ngay_vao_Dang": "21.07.2001",
                    "So_the_Dang": "92023456 042667",
                    "Chuc_vu": "GĐTT",
                    "Trinh_do": "12/12 - ThS KT Điện tử",
                    "Que_quan": "Xã Đa Phúc, TP. Hà Nội",
                    "Chuc_vu_Dang": "Bí thư ĐUBP"
                },
                {
                    "STT": 5,
                    "Anh": "",
                    "Ho_va_Ten": "Hoàng Trung Đông",
                    "Ngay_sinh": "04.10.82",
                    "Ngay_vao_Dang": "06.08.2010",
                    "So_the_Dang": "83.015113 044835",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - Kỹ sư Điện - Tự động hoá XNCN",
                    "Que_quan": "Xã Hưng Vũ, Tỉnh Lạng Sơn",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 6,
                    "Anh": "",
                    "Ho_va_Ten": "Bùi Quang Nghiệp",
                    "Ngay_sinh": "08.09.72",
                    "Ngay_vao_Dang": "27.10.2005",
                    "So_the_Dang": "92031352 043194",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - KS điện tự động hoá",
                    "Que_quan": "Xã Nam Ninh, Tỉnh Ninh Bình",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 7,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Văn Lên",
                    "Ngay_sinh": "27.10.66",
                    "Ngay_vao_Dang": "01.02.2009",
                    "So_the_Dang": "83.018902 044745",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "10/10 - KS Hệ thống điện",
                    "Que_quan": "Xã Phạm Ngũ Lão, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 8,
                    "Anh": "",
                    "Ho_va_Ten": "Nông Quang Huy",
                    "Ngay_sinh": "10.01.77",
                    "Ngay_vao_Dang": "08.10.2004",
                    "So_the_Dang": "92029783 043134",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - Thạc sỹ kỹ thuật viễn thông",
                    "Que_quan": "Xã Hà Quảng , Tỉnh Cao Bằng",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 9,
                    "Anh": "",
                    "Ho_va_Ten": "Phạm Ngọc Yến",
                    "Ngay_sinh": "18.03.68",
                    "Ngay_vao_Dang": "12.01.2002",
                    "So_the_Dang": "92002401 042935",
                    "Chuc_vu": "Tổ phó",
                    "Trinh_do": "10/10 - CĐ ĐTVT",
                    "Que_quan": "Xã Đường An, TP. Hải Phòng",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 10,
                    "Anh": "",
                    "Ho_va_Ten": "Dương Thị Hạnh",
                    "Ngay_sinh": "21.08.78",
                    "Ngay_vao_Dang": "01.08.2008",
                    "So_the_Dang": "83.018822 044711",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - KS điện tử viễn thông",
                    "Que_quan": "Xã Điềm Thụy, Tỉnh Thái Nguyên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 11,
                    "Anh": "",
                    "Ho_va_Ten": "Trần Ngọc Hòa",
                    "Ngay_sinh": "05.12.68",
                    "Ngay_vao_Dang": "07.01.2010",
                    "So_the_Dang": "83.016552 044810",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "10/10 - KS điện tử viễn thông",
                    "Que_quan": "Xã Kiến Dương, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 12,
                    "Anh": "",
                    "Ho_va_Ten": "Chu Văn Quả",
                    "Ngay_sinh": "18.08.71",
                    "Ngay_vao_Dang": "05.12.2006",
                    "So_the_Dang": "92034765 044180",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - TC điện tử - viễn thông",
                    "Que_quan": "Xã Tiên Lục, Tỉnh Bắc Ninh",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 13,
                    "Anh": "",
                    "Ho_va_Ten": "Hoàng Hắc Hải",
                    "Ngay_sinh": "08.01.1975",
                    "Ngay_vao_Dang": "31.10.2012",
                    "So_the_Dang": "83025482",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Kỹ sư điện tử - viễn thông",
                    "Que_quan": "Xã Quảng Yên, Tỉnh Cao Bằng",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 14,
                    "Anh": "",
                    "Ho_va_Ten": "Trần Hiển Thảo",
                    "Ngay_sinh": "06.02.1986",
                    "Ngay_vao_Dang": "02.10.2014",
                    "So_the_Dang": "83028859",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - TC Điện tử",
                    "Que_quan": "Phường Phổ Yên, Tỉnh Thái Nguyên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 15,
                    "Anh": "",
                    "Ho_va_Ten": "Trần Sơn Trà",
                    "Ngay_sinh": "10.06.1982",
                    "Ngay_vao_Dang": "06.11.2015",
                    "So_the_Dang": "83034293",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - KS Tự động hóa xí nghiệp CN",
                    "Que_quan": "Xã Vũ Tiên, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 16,
                    "Anh": "",
                    "Ho_va_Ten": "Đào Mạnh Tùng",
                    "Ngay_sinh": "05.7.1986",
                    "Ngay_vao_Dang": "26.12.2017",
                    "So_the_Dang": "83042770",
                    "Chuc_vu": "Phó đội trưởng",
                    "Trinh_do": "12/12 - KS Công nghệ TT",
                    "Que_quan": "Xã Hạ Hòa, Tỉnh Phú Thọ",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 17,
                    "Anh": "",
                    "Ho_va_Ten": "Phạm Văn Hoà",
                    "Ngay_sinh": "14.05.65",
                    "Ngay_vao_Dang": "21.01.2004",
                    "So_the_Dang": "92023152 043149",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "10/10 - TCSC",
                    "Que_quan": "Xã Tứ Kỳ, TP. Hải Phòng",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 18,
                    "Anh": "",
                    "Ho_va_Ten": "Trần Ngọc Tuyền",
                    "Ngay_sinh": "05.01.1989",
                    "Ngay_vao_Dang": "06.9.2019",
                    "So_the_Dang": "83.049229",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Kỹ sư công nghệ kỹ thuật điện tử, truyền thông",
                    "Que_quan": "Xã Hòa Xá, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 19,
                    "Anh": "",
                    "Ho_va_Ten": "Kiều Đình Lộc",
                    "Ngay_sinh": "24/02/1992",
                    "Ngay_vao_Dang": "06/9/2020",
                    "So_the_Dang": "83050726",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Cao đẳng điện tử-viễn thông",
                    "Que_quan": "Xã Yên Lãng, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 20,
                    "Anh": "",
                    "Ho_va_Ten": "Đỗ Quý Kiệm",
                    "Ngay_sinh": "12/08/1991",
                    "Ngay_vao_Dang": "13/12/2020",
                    "So_the_Dang": "83051662",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Kỹ sư điện tử viễn thông",
                    "Que_quan": "Xã Thanh Miện, TP. Hải Phòng",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 21,
                    "Anh": "",
                    "Ho_va_Ten": "Trần Trung Kiên",
                    "Ngay_sinh": "24/7/1990",
                    "Ngay_vao_Dang": "21/5/2022",
                    "So_the_Dang": "92102877",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - Thạc sỹ quản lý dự án, Kỹ sư Điện – Điện tử",
                    "Que_quan": "Xã Kim Thành, TP. Hải Phòng",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 22,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Lâm Tùng",
                    "Ngay_sinh": "14/02/1978",
                    "Ngay_vao_Dang": "10/01/2023",
                    "So_the_Dang": "92105632",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Kỹ sư Cơ khí ô tô",
                    "Que_quan": "Xã Quỳnh Phú, Tỉnh Nghệ An",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 23,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Chiến Thắng",
                    "Ngay_sinh": "30/4/1996",
                    "Ngay_vao_Dang": "06/7/2023",
                    "So_the_Dang": "92111720",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - KS Công nghệ kỹ thuật điện - điện tử.",
                    "Que_quan": "Xã Đồng Việt, Tỉnh Bắc Ninh",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 24,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Ngọc Văn",
                    "Ngay_sinh": "02/05/1985",
                    "Ngay_vao_Dang": "01/11/2023",
                    "So_the_Dang": "92108375",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - KS kỹ thuật điều khiển và tự động hóa",
                    "Que_quan": "Xã Kiến Xương, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 25,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Việt Hưng",
                    "Ngay_sinh": "29/11/1996",
                    "Ngay_vao_Dang": "01/11/2023",
                    "So_the_Dang": "92108376",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Công nghệ kỹ thuật điện - điện tử",
                    "Que_quan": "Xã Dân Chủ, Tỉnh Phú Thọ",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 26,
                    "Anh": "",
                    "Ho_va_Ten": "Hà Tiến Công",
                    "Ngay_sinh": "05.04.1979",
                    "Ngay_vao_Dang": "03.11.2018",
                    "So_the_Dang": "83050735",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - Thạc sỹ khoa học kỹ thuật viễn thông",
                    "Que_quan": "Xã Quỹ Nhất, Tỉnh Ninh Bình",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 27,
                    "Anh": "",
                    "Ho_va_Ten": "Phạm Quang Tiến",
                    "Ngay_sinh": "13.02.1991",
                    "Ngay_vao_Dang": "07.7.2023",
                    "So_the_Dang": "83067886",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - Kỹ sư Kỹ thuật Điện, Điện tử",
                    "Que_quan": "Xã Thanh Miện, TP. Hải Phòng",
                    "Chuc_vu_Dang": ""
                }
            ],
            'doi-moi-truong-khu-bay': [
                {
                    "STT": 1,
                    "Anh": "",
                    "Ho_va_Ten": "Trần Xuân May",
                    "Ngay_sinh": "02.09.65",
                    "Ngay_vao_Dang": "05.12.1999",
                    "So_the_Dang": "92023398 042829",
                    "Chuc_vu": "Lái xe",
                    "Trinh_do": "10/10 - Lái xe",
                    "Que_quan": "Việt Hoà - Khoái Châu - Hưng Yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 2,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Đình Được",
                    "Ngay_sinh": "24.10.1982",
                    "Ngay_vao_Dang": "28.02.2013",
                    "So_the_Dang": "83022797 045501",
                    "Chuc_vu": "Lái xe",
                    "Trinh_do": "12/12 - LĐPT",
                    "Que_quan": "Mai Đình - Sóc Sơn - Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 3,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Duy Hoan",
                    "Ngay_sinh": "26.06.70",
                    "Ngay_vao_Dang": "19.05.2001",
                    "So_the_Dang": "92002414 042966",
                    "Chuc_vu": "Đội trưởng",
                    "Trinh_do": "12/12 - CN Kinh tế",
                    "Que_quan": "Trang Bảo Xá - Quỳnh Phụ - Thái Bình",
                    "Chuc_vu_Dang": "Bí thư CB"
                },
                {
                    "STT": 4,
                    "Anh": "",
                    "Ho_va_Ten": "Ngô Thế Giang",
                    "Ngay_sinh": "05.7.1976",
                    "Ngay_vao_Dang": "10.7.2018",
                    "So_the_Dang": "83044317",
                    "Chuc_vu": "",
                    "Trinh_do": "12/12 - Lái xe",
                    "Que_quan": "X. Nga Bạch - H. Nga Sơn - T. Thanh Hoá",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 5,
                    "Anh": "",
                    "Ho_va_Ten": "Hoàng Trung Kiên",
                    "Ngay_sinh": "11.10.1984",
                    "Ngay_vao_Dang": "09.12.2016",
                    "So_the_Dang": "83039530 022604",
                    "Chuc_vu": "Tổ phó",
                    "Trinh_do": "12/12",
                    "Que_quan": "Thành Lợi- Vụ Bản- Nam Định",
                    "Chuc_vu_Dang": "CUV"
                },
                {
                    "STT": 6,
                    "Anh": "",
                    "Ho_va_Ten": "Hoàng Văn Thành",
                    "Ngay_sinh": "20.10.1992",
                    "Ngay_vao_Dang": "11.7.2019",
                    "So_the_Dang": "83047818",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Cử nhân Luật kinh tế",
                    "Que_quan": "Xã Xuân Trường- Nghi Xuân- Hà Tĩnh",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 7,
                    "Anh": "",
                    "Ho_va_Ten": "Phạm Quang Nhàn",
                    "Ngay_sinh": "10.12.1983",
                    "Ngay_vao_Dang": "02.11.2011",
                    "So_the_Dang": "83019930",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Lái xe",
                    "Que_quan": "Thanh Xuân - Sóc Sơn  - Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 8,
                    "Anh": "",
                    "Ho_va_Ten": "Phạm Tự Cường",
                    "Ngay_sinh": "29.08.65",
                    "Ngay_vao_Dang": "29.11.2006",
                    "So_the_Dang": "92034751 044185",
                    "Chuc_vu": "Phó đội trưởng",
                    "Trinh_do": "10/10 - Trung cấp Xây dựng",
                    "Que_quan": "Giao Tiến - Giao Thuỷ - Nam Định",
                    "Chuc_vu_Dang": "Phó BTCB"
                },
                {
                    "STT": 9,
                    "Anh": "",
                    "Ho_va_Ten": "Trần Anh Tuyên",
                    "Ngay_sinh": "23.12.1982",
                    "Ngay_vao_Dang": "",
                    "So_the_Dang": "",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Lái xe",
                    "Que_quan": "X. Hồng Khê, H. Bình Giang, T. Hải Dương.",
                    "Chuc_vu_Dang": "ĐVDB"
                },
                {
                    "STT": 10,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Việt Nam",
                    "Ngay_sinh": "12.12.1993",
                    "Ngay_vao_Dang": "",
                    "So_the_Dang": "",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - Lái xe",
                    "Que_quan": "P. Hòa Long, TP. Bắc Ninh, T. Bắc Ninh",
                    "Chuc_vu_Dang": "ĐVDB"
                }
            ],
            'doi-bao-tri-san-duong': [
                {
                    "STT": 1,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Tiến Dũng",
                    "Ngay_sinh": "15.05.76",
                    "Ngay_vao_Dang": "31.12.2009",
                    "So_the_Dang": "83.016532 044798",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - SC",
                    "Que_quan": "Xã Hùng Việt, Tỉnh Phú Thọ",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 2,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Đức Thành",
                    "Ngay_sinh": "14.09.1981",
                    "Ngay_vao_Dang": "07.11.2015",
                    "So_the_Dang": "83034294",
                    "Chuc_vu": "Kỹ sư",
                    "Trinh_do": "12/12 - KS xây dựng",
                    "Que_quan": "Phường Điện Bàn Bắc, TP. Đà Nẵng",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 3,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Duy Tuân",
                    "Ngay_sinh": "27.10.1980",
                    "Ngay_vao_Dang": "21.5.2016",
                    "So_the_Dang": "83036640",
                    "Chuc_vu": "Kỹ thuật viên",
                    "Trinh_do": "12/12 - TC Thủy lợi",
                    "Que_quan": "Xã Quỳnh An, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 4,
                    "Anh": "",
                    "Ho_va_Ten": "Tạ Minh Tiến",
                    "Ngay_sinh": "23.8.1985",
                    "Ngay_vao_Dang": "30.9.2016",
                    "So_the_Dang": "83039502",
                    "Chuc_vu": "Phó đội trưởng",
                    "Trinh_do": "12/12 - KS XD dân dụng và CN",
                    "Que_quan": "Xã Việt Tiến, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": "Phó BTCB"
                },
                {
                    "STT": 5,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Văn Dũng",
                    "Ngay_sinh": "21.10.1981",
                    "Ngay_vao_Dang": "30.9.2016",
                    "So_the_Dang": "83039503",
                    "Chuc_vu": "Kỹ thuật viên",
                    "Trinh_do": "12/12 - KS XD đường bộ",
                    "Que_quan": "Xã Việt Tiến, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 6,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Thiết Hùng",
                    "Ngay_sinh": "26.9.1983",
                    "Ngay_vao_Dang": "10.12.2016",
                    "So_the_Dang": "83039512",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - KS XD cầu đường",
                    "Que_quan": "Xã Liên Bão, Tỉnh Bắc Ninh",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 7,
                    "Anh": "",
                    "Ho_va_Ten": "Vũ Quang Nam",
                    "Ngay_sinh": "23.9.1984",
                    "Ngay_vao_Dang": "12.7.2019",
                    "So_the_Dang": "83047820",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - lái xe",
                    "Que_quan": "Xã Hùng Thắng, TP. Hải Phòng",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 8,
                    "Anh": "",
                    "Ho_va_Ten": "Đỗ Quang Tiến",
                    "Ngay_sinh": "25.01.1971",
                    "Ngay_vao_Dang": "01.12.2006",
                    "So_the_Dang": "92034764 044177",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - CN Quản trị kinh doanh",
                    "Que_quan": "Xã Bình Mỹ, Tỉnh Ninh Bình",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 9,
                    "Anh": "",
                    "Ho_va_Ten": "Đặng Minh Lân",
                    "Ngay_sinh": "06.10.1991",
                    "Ngay_vao_Dang": "25.12.2021",
                    "So_the_Dang": "92101515",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - KS kỹ thuật công trình",
                    "Que_quan": "Phường Trà Lý, Tỉnh Hưng Yên",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 10,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Hiền Toàn",
                    "Ngay_sinh": "11.02.1988",
                    "Ngay_vao_Dang": "10/10/2021",
                    "So_the_Dang": "92101511",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - CN Quản trị kinh doanh",
                    "Que_quan": "Xã Hoài Đức, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 11,
                    "Anh": "",
                    "Ho_va_Ten": "Lê Tiến Dũng",
                    "Ngay_sinh": "19/01/1987",
                    "Ngay_vao_Dang": "2023-10-24",
                    "So_the_Dang": "92108372",
                    "Chuc_vu": "Nhân viên",
                    "Trinh_do": "12/12 - CN Quản trị kinh doanh",
                    "Que_quan": "Xã Tam Sơn, Tỉnh Phú Thọ",
                    "Chuc_vu_Dang": ""
                },
                {
                    "STT": 12,
                    "Anh": "",
                    "Ho_va_Ten": "Nguyễn Bá Mạnh",
                    "Ngay_sinh": "20/3/1985",
                    "Ngay_vao_Dang": "12/11/2015",
                    "So_the_Dang": "83034283 045602",
                    "Chuc_vu": "Phó đội trưởng",
                    "Trinh_do": "12/12 - ThS Kỹ thuật",
                    "Que_quan": "Xã Hoằng Giang, Tỉnh Thanh Hóa",
                    "Chuc_vu_Dang": "CUV"
                },
                {
                    "STT": 13,
                    "Anh": "",
                    "Ho_va_Ten": "Vũ Công Thắng",
                    "Ngay_sinh": "16.12.1965",
                    "Ngay_vao_Dang": "29.08.1988",
                    "So_the_Dang": "92002405",
                    "Chuc_vu": "Phó GĐTT",
                    "Trinh_do": "10/10 - ĐH Luật",
                    "Que_quan": "Xã Xuân Mai, TP. Hà Nội",
                    "Chuc_vu_Dang": ""
                }
            ]
        };

        // ========== CẤU HÌNH HỆ THỐNG ==========
        const chiBoNames = {
            'doi-thiet-bi-thong-tin-dan-duong': 'Đội Thiết bị Thông tin dẫn đường',
            'van-phong-trung-tam': 'Văn phòng Trung tâm',
            'doi-thiet-bi-co-dien-den-sb': 'Đội Thiết bị Cơ điện đèn SB',
            'doi-moi-truong-khu-bay': 'Đội Môi trường Khu bay',
            'doi-bao-tri-san-duong': 'Đội Bảo trì Sân đường'
        };

        let allMembers = [];
        let currentChiBo = 'doi-thiet-bi-thong-tin-dan-duong';
        let loadedChiBos = new Set();

        // ========== HÀM CHÍNH ==========

        // HÀM CHUYỂN ĐỔI DỮ LIỆU
        function convertMemberData(jsonMember, chiBoId) {
            const chucVuDang = jsonMember.Chuc_vu_Dang || '';
            const soTheDang = jsonMember.So_the_Dang || '';
            const ngayVaoDang = jsonMember.Ngay_vao_Dang || '';
            
            // Xác định trạng thái
            let trangThai = "Chính thức";
            if (chucVuDang.includes("ĐVDB") || chucVuDang === "ĐVDB") {
                trangThai = "Dự bị";
            } else if (!soTheDang || soTheDang.trim() === "" || soTheDang === "null" ||
                       !ngayVaoDang || ngayVaoDang.trim() === "" || ngayVaoDang === "null") {
                trangThai = "Dự bị";
            }
            
            // Xác định giới tính từ tên
            let gioiTinh = "Nam";
            const hoTen = jsonMember.Ho_va_Ten || '';
            const nameLower = hoTen.toLowerCase();
            if (nameLower.includes('thị ') || nameLower.includes(' thị')) {
                gioiTinh = "Nữ";
            }
            
            // Định dạng ngày
            function formatDate(dateStr) {
                if (!dateStr || dateStr.trim() === '' || dateStr === 'null') return 'N/A';
                
                let formatted = dateStr.toString().trim();
                formatted = formatted.replace(/\./g, '/');
                
                const parts = formatted.split('/');
                if (parts.length >= 3) {
                    const year = parts[2];
                    if (year.length === 2) {
                        const yearNum = parseInt(year);
                        parts[2] = yearNum < 50 ? '20' + year : '19' + year;
                        formatted = parts.join('/');
                    }
                }
                
                return formatted;
            }
            
            return {
                id: `${chiBoId}-${jsonMember.STT}`,
                hoTen: hoTen,
                ngaySinh: formatDate(jsonMember.Ngay_sinh),
                gioiTinh: gioiTinh,
                ngayVaoDang: formatDate(ngayVaoDang),
                chucVu: jsonMember.Chuc_vu || 'Đảng viên',
                trangThai: trangThai,
                chiBo: chiBoId,
                chiBoName: chiBoNames[chiBoId],
                noiSinh: jsonMember.Que_quan || 'Không rõ',
                danToc: 'Kinh',
                tonGiao: 'Không',
                ngheNghiep: jsonMember.Chuc_vu || 'Cán bộ',
                trinhDo: jsonMember.Trinh_do || 'Không rõ',
                soTheDang: soTheDang,
                chucVuDang: chucVuDang
            };
        }

        // HÀM LOAD DỮ LIỆU
        async function loadAllData() {
            allMembers = [];
            loadedChiBos.clear();
            
            for (const [chiBoId, data] of Object.entries(embeddedData)) {
                data.forEach(jsonMember => {
                    const member = convertMemberData(jsonMember, chiBoId);
                    allMembers.push(member);
                });
                loadedChiBos.add(chiBoId);
            }
            
            console.log('Đã tải dữ liệu từ 5 chi bộ. Tổng số:', allMembers.length);
        }

        // HÀM KHỞI TẠO
        async function init() {
            console.log('Đang khởi tạo hệ thống...');
            
            try {
                await loadAllData();
                updateStatistics();
                displayChiBoData(currentChiBo);
            } catch (error) {
                console.error('Lỗi khởi tạo:', error);
                showError('Có lỗi xảy ra khi tải dữ liệu');
            }
        }

        // CẬP NHẬT THỐNG KÊ
        function updateStatistics() {
            const totalMembers = allMembers.length;
            const totalChinhThuc = allMembers.filter(m => m.trangThai === 'Chính thức').length;
            const totalDuBi = allMembers.filter(m => m.trangThai === 'Dự bị').length;
            
            document.getElementById('totalMembers').textContent = totalMembers;
            document.getElementById('totalChinhThuc').textContent = totalChinhThuc;
            document.getElementById('totalDuBi').textContent = totalDuBi;
            document.getElementById('activeChiBo').textContent = `${loadedChiBos.size}/5`;
            
            // Thống kê đảng viên mới 2024
            const currentYear = new Date().getFullYear();
            const newMembers2024 = allMembers.filter(m => {
                if (m.ngayVaoDang && m.ngayVaoDang !== 'N/A') {
                    const yearMatch = m.ngayVaoDang.match(/\/(\d{4})$/);
                    if (yearMatch) {
                        const year = parseInt(yearMatch[1]);
                        return year >= 2020; // Đảng viên mới từ 2020
                    }
                }
                return false;
            }).length;
            
            const pendingMembers = allMembers.filter(m => m.trangThai === 'Dự bị').length;
            
            document.getElementById('newMembers2025').textContent = newMembers2024;
            document.getElementById('pendingMembers').textContent = pendingMembers;
            document.getElementById('uuTuMembers').textContent = Math.floor(totalMembers * 0.21);
        }

        // HÀM CHUYỂN TAB
        function switchTab(chiBoId) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.chibo === chiBoId) {
                    btn.classList.add('active');
                }
            });
            
            currentChiBo = chiBoId;
            displayChiBoData(chiBoId);
        }

        // HIỂN THỊ DỮ LIỆU CHI BỘ
        function displayChiBoData(chiBoId) {
            const tabContent = document.getElementById('tabContent');
            tabContent.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Đang tải dữ liệu ${chiBoNames[chiBoId]}...</p>
                </div>
            `;
            
            setTimeout(() => {
                renderMembersTable(chiBoId);
            }, 300);
        }

        // RENDER BẢNG ĐẢNG VIÊN
        function renderMembersTable(chiBoId) {
            const chiBoMembers = allMembers.filter(member => member.chiBo === chiBoId);
            const tabContent = document.getElementById('tabContent');
            
            if (chiBoMembers.length === 0) {
                tabContent.innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-users-slash" style="font-size: 48px; margin-bottom: 20px;"></i>
                        <h3>Không có dữ liệu</h3>
                        <p>Chi bộ ${chiBoNames[chiBoId]} chưa có dữ liệu đảng viên.</p>
                    </div>
                `;
                return;
            }
            
            let tableHTML = `
                <div class="table-container">
                    <table class="member-table">
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>Họ và tên</th>
                                <th>Ngày sinh</th>
                                <th>Giới tính</th>
                                <th>Ngày vào Đảng</th>
                                <th>Chức vụ</th>
                                <th>Trạng thái</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            chiBoMembers.forEach((member, index) => {
                const statusClass = member.trangThai === 'Chính thức' ? 'status-chinh-thuc' : 'status-du-bi';
                
                tableHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td><strong>${member.hoTen}</strong></td>
                        <td>${member.ngaySinh}</td>
                        <td>${member.gioiTinh}</td>
                        <td>${member.ngayVaoDang}</td>
                        <td>${member.chucVu}</td>
                        <td><span class="status-badge ${statusClass}">${member.trangThai}</span></td>
                        <td>
                            <button onclick="viewMemberDetail('${member.id}')" class="btn-action view">
                                <i class="fas fa-eye"></i> Xem
                            </button>
                            <button onclick="editMember('${member.id}')" class="btn-action edit">
                                <i class="fas fa-edit"></i> Sửa
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            tableHTML += `
                        </tbody>
                    </table>
                </div>
                <div style="margin-top: 20px; color: #666; font-size: 14px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <i class="fas fa-info-circle"></i> Tổng số: ${chiBoMembers.length} đảng viên - Chi bộ: ${chiBoNames[chiBoId]}
                    </div>
                    <div style="font-size: 12px; color: #888;">
                        <i class="fas fa-check-circle"></i> Dữ liệu thực
                    </div>
                </div>
            `;
            
            tabContent.innerHTML = tableHTML;
        }

        // XEM CHI TIẾT ĐẢNG VIÊN
        function viewMemberDetail(memberId) {
            const member = allMembers.find(m => m.id === memberId);
            if (!member) return;
            
            let detail = `
                <div style="max-width: 500px; padding: 20px;">
                    <h3 style="color: var(--primary-red); margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px;">
                        <i class="fas fa-id-card"></i> CHI TIẾT ĐẢNG VIÊN
                    </h3>
                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px; margin-bottom: 15px;">
                        <strong>Họ tên:</strong> <span>${member.hoTen}</span>
                        <strong>Ngày sinh:</strong> <span>${member.ngaySinh}</span>
                        <strong>Giới tính:</strong> <span>${member.gioiTinh}</span>
                        <strong>Chi bộ:</strong> <span>${member.chiBoName}</span>
                        <strong>Ngày vào Đảng:</strong> <span>${member.ngayVaoDang}</span>
                        <strong>Số thẻ Đảng:</strong> <span>${member.soTheDang}</span>
                        <strong>Chức vụ:</strong> <span>${member.chucVu}</span>
                        <strong>Chức vụ Đảng:</strong> <span>${member.chucVuDang || 'N/A'}</span>
                        <strong>Trạng thái:</strong> <span>${member.trangThai}</span>
                        <strong>Nơi sinh:</strong> <span>${member.noiSinh}</span>
                        <strong>Dân tộc:</strong> <span>${member.danToc}</span>
                        <strong>Tôn giáo:</strong> <span>${member.tonGiao}</span>
                        <strong>Nghề nghiệp:</strong> <span>${member.ngheNghiep}</span>
                        <strong>Trình độ:</strong> <span>${member.trinhDo}</span>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button onclick="this.parentElement.parentElement.remove()" style="padding: 10px 20px; background: var(--primary-red); color: white; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-times"></i> Đóng
                        </button>
                    </div>
                </div>
            `;
            
            // Tạo modal hiển thị chi tiết
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">
                            <i class="fas fa-user"></i> ${member.hoTen}
                        </h3>
                        <button class="close-btn" onclick="this.parentElement.parentElement.parentElement.remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    ${detail}
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // CHỈNH SỬA ĐẢNG VIÊN
        function editMember(memberId) {
            alert(`Chức năng chỉnh sửa đang được phát triển.\n\nĐảng viên: ${memberId}`);
        }

        // ========== MODAL FUNCTIONS ==========

        function showAddMemberModal() {
            document.getElementById('addMemberModal').style.display = 'flex';
            document.getElementById('addMemberForm').reset();
        }

        function closeAddMemberModal() {
            document.getElementById('addMemberModal').style.display = 'none';
        }

        function showSearchModal() {
            document.getElementById('searchModal').style.display = 'flex';
            document.getElementById('searchResults').style.display = 'none';
            document.getElementById('searchKeyword').value = '';
        }

        function closeSearchModal() {
            document.getElementById('searchModal').style.display = 'none';
        }

        function showAdvancedSearch() {
            alert('Chức năng tìm kiếm nâng cao đang được phát triển.');
        }

        // TÌM KIẾM ĐẢNG VIÊN
        function performSearch() {
            const keyword = document.getElementById('searchKeyword').value.toLowerCase();
            const chiBo = document.getElementById('searchChiBo').value;
            const trangThai = document.getElementById('searchTrangThai').value;
            
            let results = allMembers;
            
            if (keyword) {
                results = results.filter(member => 
                    member.hoTen.toLowerCase().includes(keyword) ||
                    member.chucVu.toLowerCase().includes(keyword) ||
                    member.noiSinh.toLowerCase().includes(keyword) ||
                    member.trinhDo.toLowerCase().includes(keyword)
                );
            }
            
            if (chiBo) {
                results = results.filter(member => member.chiBo === chiBo);
            }
            
            if (trangThai) {
                results = results.filter(member => member.trangThai === trangThai);
            }
            
            displaySearchResults(results);
        }

        function displaySearchResults(results) {
            const resultsDiv = document.getElementById('searchResults');
            
            if (results.length === 0) {
                resultsDiv.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #666;">
                        <i class="fas fa-search" style="font-size: 48px; margin-bottom: 10px;"></i>
                        <p>Không tìm thấy đảng viên nào phù hợp</p>
                    </div>
                `;
            } else {
                let resultsHTML = `
                    <h4 style="margin-bottom: 15px; color: var(--primary-red);">
                        <i class="fas fa-list"></i> Kết quả tìm kiếm (${results.length})
                    </h4>
                    <div style="max-height: 200px; overflow-y: auto;">
                `;
                
                results.forEach((member, index) => {
                    resultsHTML += `
                        <div style="padding: 10px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>${member.hoTen}</strong><br>
                                <small style="color: #666;">${member.chiBoName} - ${member.chucVu}</small>
                            </div>
                            <button onclick="viewMemberDetail('${member.id}')" style="padding: 5px 10px; background: #17a2b8; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 12px;">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    `;
                });
                
                resultsHTML += `</div>`;
                resultsDiv.innerHTML = resultsHTML;
            }
            
            resultsDiv.style.display = 'block';
        }

        // XUẤT EXCEL
        function exportToExcel() {
            // Tạo dữ liệu CSV
            let csv = 'STT,Họ và tên,Ngày sinh,Giới tính,Ngày vào Đảng,Chức vụ,Trạng thái,Chi bộ,Quê quán,Trình độ,Số thẻ Đảng\n';
            
            allMembers.forEach((member, index) => {
                csv += `"${index + 1}","${member.hoTen}","${member.ngaySinh}","${member.gioiTinh}","${member.ngayVaoDang}","${member.chucVu}","${member.trangThai}","${member.chiBoName}","${member.noiSinh}","${member.trinhDo}","${member.soTheDang}"\n`;
            });
            
            // Tạo file download
            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `danh-sach-dang-vien-${new Date().toISOString().slice(0,10)}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert(`Đã xuất file CSV thành công!\n\nTổng số: ${allMembers.length} đảng viên`);
        }

        // LÀM MỚI DỮ LIỆU
        async function refreshData() {
            const tabContent = document.getElementById('tabContent');
            tabContent.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Đang làm mới dữ liệu...</p>
                </div>
            `;
            
            try {
                await loadAllData();
                updateStatistics();
                displayChiBoData(currentChiBo);
                
                // Hiển thị thông báo thành công
                const infoMessage = document.getElementById('infoMessage');
                infoMessage.className = 'success-message';
                infoMessage.innerHTML = `<i class="fas fa-check-circle"></i> Đã làm mới dữ liệu thành công! Tổng cộng ${allMembers.length} đảng viên.`;
                
                // Ẩn thông báo sau 3 giây
                setTimeout(() => {
                    infoMessage.style.display = 'none';
                }, 3000);
                
            } catch (error) {
                console.error('Lỗi làm mới dữ liệu:', error);
                showError('Không thể làm mới dữ liệu');
            }
        }

        // HIỂN THỊ LỖI
        function showError(message) {
            const infoMessage = document.getElementById('infoMessage');
            infoMessage.className = 'error-message';
            infoMessage.innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${message}`;
            infoMessage.style.display = 'block';
        }

        // XỬ LÝ FORM THÊM ĐẢNG VIÊN
        document.getElementById('addMemberForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newMember = {
                STT: allMembers.filter(m => m.chiBo === document.getElementById('newChiBo').value).length + 1,
                Anh: "",
                Ho_va_Ten: document.getElementById('newHoVaTen').value,
                Ngay_sinh: document.getElementById('newNgaySinh').value,
                Ngay_vao_Dang: document.getElementById('newNgayVaoDang').value,
                So_the_Dang: document.getElementById('newSoTheDang').value,
                Chuc_vu: document.getElementById('newChucVu').value,
                Trinh_do: document.getElementById('newTrinhDo').value,
                Que_quan: document.getElementById('newQueQuan').value,
                Chuc_vu_Dang: document.getElementById('newChucVuDang').value
            };
            
            const chiBoId = document.getElementById('newChiBo').value;
            
            // Thêm vào dữ liệu nhúng
            if (!embeddedData[chiBoId]) {
                embeddedData[chiBoId] = [];
            }
            embeddedData[chiBoId].push(newMember);
            
            // Cập nhật giao diện
            closeAddMemberModal();
            refreshData();
            
            alert('Đã thêm đảng viên mới thành công!');
        });

        // THÊM CSS CHO NÚT HÀNH ĐỘNG
        const style = document.createElement('style');
        style.textContent = `
            .btn-action {
                padding: 6px 12px;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 13px;
                margin: 0 2px;
                display: inline-flex;
                align-items: center;
                gap: 5px;
            }
            
            .btn-action.view {
                background: #17a2b8;
                color: white;
            }
            
            .btn-action.edit {
                background: #28a745;
                color: white;
            }
            
            .btn-action:hover {
                opacity: 0.9;
                transform: translateY(-1px);
            }
            
            .error-message {
                background: #f8d7da;
                border-left: 4px solid #dc3545;
                padding: 15px;
                margin: 20px 0;
                border-radius: 4px;
                color: #721c24;
            }
        `;
        document.head.appendChild(style);

        // KHỞI TẠO KHI TRANG LOAD
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
